---
import DocLayout from "@layouts/DocLayout.astro";
import { Code } from "astro:components";
import DropdownComponent from "@components/ui/Dropdown.astro";

const menuItems = [
  { label: "Profile", value: "profile", icon: "ğŸ‘¤" },
  { label: "Settings", value: "settings", icon: "âš™ï¸" },
  { label: "Messages", value: "messages", icon: "ğŸ’¬" },
  { label: "Notifications", value: "notifications", icon: "ğŸ””" },
  { label: "Help", value: "help", icon: "â“" },
  { label: "Logout", value: "logout", icon: "ğŸšª" },
];

const shortMenu = menuItems.slice(0, 3);

const longMenu = [
  ...menuItems,
  { label: "Dashboard", value: "dashboard", icon: "ğŸ“Š" },
  { label: "Analytics", value: "analytics", icon: "ğŸ“ˆ" },
  { label: "Reports", value: "reports", icon: "ğŸ“„" },
  { label: "Team", value: "team", icon: "ğŸ‘¥" },
  { label: "Projects", value: "projects", icon: "ğŸ“" },
  { label: "Calendar", value: "calendar", icon: "ğŸ“…" },
  { label: "Tasks", value: "tasks", icon: "âœ“" },
  { label: "Files", value: "files", icon: "ğŸ“‚" },
];

const menuWithLinks = [
  { label: "Home", href: "#home", icon: "ğŸ " },
  { label: "About", href: "#about", icon: "â„¹ï¸" },
  { label: "Contact", href: "#contact", icon: "ğŸ“§" },
  { label: "Blog", href: "#blog", icon: "ğŸ“" },
];

const menuWithDisabled = [
  { label: "Edit", value: "edit", icon: "âœï¸" },
  { label: "Delete", value: "delete", icon: "ğŸ—‘ï¸", disabled: true },
  { label: "Share", value: "share", icon: "ğŸ”—" },
];

const recursiveMenu = [
  { label: "Dashboard", value: "dashboard", icon: "ğŸ“Š" },
  { 
    label: "Products", 
    value: "products", 
    icon: "ğŸ“¦",
    children: [
      { label: "All Products", value: "products-all", icon: "ğŸ—‚ï¸" },
      { label: "Categories", value: "categories", icon: "ğŸ“‚",
        children: [
          { label: "Electronics", value: "cat-electronics", icon: "âš¡" },
          { label: "Clothing", value: "cat-clothing", icon: "ğŸ‘•" },
          { label: "Books", value: "cat-books", icon: "ğŸ“š" },
        ]
      },
      { label: "Add Product", value: "product-add", icon: "â•" },
    ]
  },
  {
    label: "Settings",
    value: "settings",
    icon: "âš™ï¸",
    children: [
      { label: "Profile", value: "settings-profile", icon: "ğŸ‘¤" },
      { label: "Security", value: "settings-security", icon: "ğŸ”’",
        children: [
          { label: "Password", value: "change-password", icon: "ğŸ”‘" },
          { label: "2FA", value: "2fa", icon: "ğŸ›¡ï¸" },
        ]
      },
      { label: "Notifications", value: "settings-notif", icon: "ğŸ””" },
    ]
  },
  { label: "Logout", value: "logout", icon: "ğŸšª" },
];
---

<DocLayout 
  title="Dropdown Component" 
  description="Menu dÃ©roulant avec positionnement intelligent et gestion responsive (ZERO JavaScript)" 
  variant="initial"
>
  <h1 id="dropdown-component">Dropdown Component</h1>

  <p>
    Le composant <code class="inline-code">Dropdown</code> utilise le checkbox hack CSS pour crÃ©er
    des menus dÃ©roulants sans JavaScript. Gestion intelligente du positionnement et du responsive.
  </p>

  <div class="toc">
    <h2>Table des matiÃ¨res</h2>
    <ul>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#basic">Utilisation basique</a></li>
      <li><a href="#recursive">Menus rÃ©cursifs</a></li>
      <li><a href="#positions">Positions</a></li>
      <li><a href="#variants">Variants</a></li>
      <li><a href="#features">FonctionnalitÃ©s</a></li>
      <li><a href="#api">API Reference</a></li>
    </ul>
  </div>

  <h2 id="installation">Installation</h2>

  <Code
    lang="astro"
    code={`import Dropdown from '@components/ui/Dropdown.astro';`}
  />

  <h2 id="basic">Utilisation basique</h2>

  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      triggerLabel="Menu"
      triggerIcon="â˜°"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  triggerLabel="Menu"
  triggerIcon="â˜°"
/>`}
  />

  <h2 id="recursive">Menus rÃ©cursifs (multi-niveaux)</h2>
  <p>
    Les dropdowns supportent les sous-menus imbriquÃ©s Ã  plusieurs niveaux sans JavaScript. 
    Chaque sous-menu a sa propre checkbox pour l'Ã©tat d'ouverture/fermeture.
  </p>

  <div class="demo-section">
    <DropdownComponent 
      items={recursiveMenu}
      triggerLabel="Menu Multi-niveaux"
      triggerIcon="ğŸ“"
    />
  </div>

  <Code
    lang="astro"
    code={`const recursiveMenu = [
  { label: "Dashboard", value: "dashboard", icon: "ğŸ“Š" },
  { 
    label: "Products", 
    icon: "ğŸ“¦",
    children: [
      { label: "All Products", value: "products-all", icon: "ğŸ—‚ï¸" },
      { 
        label: "Categories", 
        icon: "ğŸ“‚",
        children: [
          { label: "Electronics", value: "cat-electronics", icon: "âš¡" },
          { label: "Clothing", value: "cat-clothing", icon: "ğŸ‘•" },
          { label: "Books", value: "cat-books", icon: "ğŸ“š" },
        ]
      },
      { label: "Add Product", value: "product-add", icon: "â•" },
    ]
  },
  {
    label: "Settings",
    icon: "âš™ï¸",
    children: [
      { label: "Profile", value: "settings-profile", icon: "ğŸ‘¤" },
      { 
        label: "Security", 
        icon: "ğŸ”’",
        children: [
          { label: "Password", value: "change-password", icon: "ğŸ”‘" },
          { label: "2FA", value: "2fa", icon: "ğŸ›¡ï¸" },
        ]
      },
      { label: "Notifications", value: "settings-notif", icon: "ğŸ””" },
    ]
  },
  { label: "Logout", value: "logout", icon: "ğŸšª" },
];

<DropdownComponent items={recursiveMenu} triggerLabel="Menu Multi-niveaux" />`}
  />

  <div class="note">
    <strong>ZERO JavaScript :</strong> Chaque sous-menu utilise une checkbox cachÃ©e + label pour gÃ©rer son Ã©tat.
    Les sous-menus s'ouvrent Ã  droite (desktop) ou en empilÃ© (mobile). Support illimitÃ© de niveaux d'imbrication !
  </div>

  <h2 id="positions">Positions</h2>
  <p>Le dropdown peut Ãªtre positionnÃ© de 4 faÃ§ons diffÃ©rentes par rapport au trigger.</p>

  <div class="demo-section" style="display: flex; gap: 2rem; flex-wrap: wrap; justify-content: space-between;">
    <div>
      <h4>Bottom Left (dÃ©faut)</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Bottom Left"
        position="bottom-left"
      />
    </div>

    <div>
      <h4>Bottom Right</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Bottom Right"
        position="bottom-right"
      />
    </div>

    <div>
      <h4>Top Left</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Top Left"
        position="top-left"
      />
    </div>

    <div>
      <h4>Top Right</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Top Right"
        position="top-right"
      />
    </div>
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent items={items} position="bottom-left" />
<DropdownComponent items={items} position="bottom-right" />
<DropdownComponent items={items} position="top-left" />
<DropdownComponent items={items} position="top-right" />`}
  />

  <h2 id="variants">Variants</h2>

  <h3>Variant Retro</h3>
  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      variant="retro"
      triggerLabel="RETRO MENU"
      triggerIcon="â–£"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  variant="retro"
  triggerLabel="RETRO MENU"
/>`}
  />

  <h3>Variant Modern</h3>
  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      variant="modern"
      triggerLabel="Modern Menu"
      triggerIcon="âœ¨"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  variant="modern"
  triggerLabel="Modern Menu"
/>`}
  />

  <h3>Variant Futuristic</h3>
  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      variant="futuristic"
      triggerLabel="FUTURISTIC"
      triggerIcon="â—ˆ"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  variant="futuristic"
  triggerLabel="FUTURISTIC"
/>`}
  />

  <h2 id="features">FonctionnalitÃ©s</h2>

  <h3>Menu avec liens</h3>
  <p>Les items peuvent avoir des attributs <code class="inline-code">href</code> pour crÃ©er des liens.</p>

  <div class="demo-section">
    <DropdownComponent 
      items={menuWithLinks}
      triggerLabel="Navigation"
      triggerIcon="ğŸ”—"
    />
  </div>

  <Code
    lang="astro"
    code={`const menuWithLinks = [
  { label: "Home", href: "#home", icon: "ğŸ " },
  { label: "About", href: "#about", icon: "â„¹ï¸" },
  { label: "Contact", href: "#contact", icon: "ğŸ“§" },
];

<DropdownComponent items={menuWithLinks} triggerLabel="Navigation" />`}
  />

  <h3>Items dÃ©sactivÃ©s</h3>

  <div class="demo-section">
    <DropdownComponent 
      items={menuWithDisabled}
      triggerLabel="Actions"
      triggerIcon="âš¡"
    />
  </div>

  <Code
    lang="astro"
    code={`const menuWithDisabled = [
  { label: "Edit", value: "edit", icon: "âœï¸" },
  { label: "Delete", value: "delete", icon: "ğŸ—‘ï¸", disabled: true },
  { label: "Share", value: "share", icon: "ğŸ”—" },
];`}
  />

  <h3>Menu long avec scroll</h3>
  <p>Les menus longs ont un scroll automatique avec une hauteur max de 400px.</p>

  <div class="demo-section">
    <DropdownComponent 
      items={longMenu}
      triggerLabel="Long Menu"
      triggerIcon="ğŸ“‹"
    />
  </div>

  <h2 id="api">API Reference</h2>

  <h3>Props</h3>

  <div class="props-table">
    <table>
      <thead>
        <tr>
          <th>Prop</th>
          <th>Type</th>
          <th>DÃ©faut</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>items</code></td>
          <td><code>MenuItem[]</code></td>
          <td>-</td>
          <td>Tableau d'items du menu</td>
        </tr>
        <tr>
          <td><code>variant</code></td>
          <td><code>"initial" | "retro" | "modern" | "futuristic"</code></td>
          <td><code>"initial"</code></td>
          <td>Style visuel du dropdown</td>
        </tr>
        <tr>
          <td><code>position</code></td>
          <td><code>"bottom-left" | "bottom-right" | "top-left" | "top-right"</code></td>
          <td><code>"bottom-left"</code></td>
          <td>Position du menu par rapport au trigger</td>
        </tr>
        <tr>
          <td><code>triggerLabel</code></td>
          <td><code>string</code></td>
          <td><code>"Menu"</code></td>
          <td>Texte du bouton</td>
        </tr>
        <tr>
          <td><code>triggerIcon</code></td>
          <td><code>string</code></td>
          <td>-</td>
          <td>IcÃ´ne du bouton</td>
        </tr>
        <tr>
          <td><code>class</code></td>
          <td><code>string</code></td>
          <td>-</td>
          <td>Classes CSS supplÃ©mentaires</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3>MenuItem Interface</h3>

  <Code
    lang="typescript"
    code={`interface MenuItem {
  label: string;         // Texte affichÃ©
  value?: string;        // Valeur de l'item
  icon?: string;         // Emoji ou icÃ´ne
  disabled?: boolean;    // Item dÃ©sactivÃ©
  href?: string;         // Lien (devient un <a>)
  children?: MenuItem[]; // Sous-menu rÃ©cursif (multi-niveaux)
}`}
  />

  <h2>Responsive & Smart Positioning</h2>

  <p>Le dropdown gÃ¨re automatiquement :</p>

  <ul>
    <li><strong>DÃ©bordement d'Ã©cran</strong> : Sur mobile, position automatique centrÃ©e</li>
    <li><strong>Hauteur max</strong> : 400px desktop, 300px mobile avec scroll</li>
    <li><strong>Largeur adaptative</strong> : max-width sur mobile pour Ã©viter le dÃ©bordement</li>
    <li><strong>Backdrop</strong> : Click en dehors ferme le menu</li>
    <li><strong>Scrollbar custom</strong> : Style minimaliste sur les navigateurs webkit</li>
  </ul>

  <div class="note">
    <strong>Note :</strong> ZERO JavaScript ! Tout fonctionne avec une checkbox cachÃ©e et le sÃ©lecteur <code>:checked</code>.
    Le backdrop utilise une <code>&lt;label&gt;</code> invisible pour fermer au click.
  </div>

  <h2>Architecture CSS Pure</h2>

  <p>Structure HTML claire et logique pour un menu dropdown avec sous-menus :</p>

  <Code
    lang="html"
    code={`<!-- Menu principal -->
<div class="dropdown">
  <input type="checkbox" id="menu" class="dropdown-state" />
  <label for="menu" class="dropdown-trigger">Menu</label>
  <label for="menu" class="dropdown-backdrop"></label>
  
  <div class="dropdown-menu position-bottom-left">
    <div class="dropdown-content">
      <!-- Item simple -->
      <label for="menu" class="dropdown-item">Dashboard</label>
      
      <!-- Item avec sous-menu -->
      <div class="dropdown-submenu">
        <input type="checkbox" id="products" class="submenu-state" />
        <label for="products" class="dropdown-item has-submenu">
          Products â–¶
        </label>
        <div class="submenu-content">
          <div class="dropdown-content">
            <label for="menu" class="dropdown-item">All Products</label>
            <!-- Peut imbriquer jusqu'Ã  3 niveaux -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>`}
  />

  <Code
    lang="css"
    code={`/* Checkbox cachÃ© pour l'Ã©tat du menu principal */
.dropdown-state {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

/* Ouvrir le menu quand checkbox cochÃ©e */
.dropdown-state:checked ~ .dropdown-menu {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

/* Backdrop transparent pour fermer au clic extÃ©rieur */
.dropdown-state:checked ~ .dropdown-backdrop {
  display: block;
}

/* Sous-menus avec leur propre checkbox */
.submenu-state:checked ~ .submenu-content {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}`}
  />
</DocLayout>

<style>
  .demo-section {
    margin: 2rem 0;
    padding: 2rem;
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    min-height: 150px;
  }

  .demo-section h4 {
    margin-top: 0;
    margin-bottom: 1rem;
    color: var(--color-text);
    font-size: 0.875rem;
  }

  .props-table {
    overflow-x: auto;
    margin: 1rem 0;
  }

  .props-table table {
    width: 100%;
    border-collapse: collapse;
  }

  .props-table th,
  .props-table td {
    padding: 0.75rem;
    text-align: left;
    border: 1px solid var(--color-border);
  }

  .props-table th {
    background: var(--color-background);
    font-weight: 600;
  }

  .props-table code {
    background: rgba(0, 0, 0, 0.05);
    padding: 0.125rem 0.25rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
  }

  .toc {
    background: var(--color-background);
    padding: 1.5rem;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: 2rem 0;
  }

  .toc h2 {
    margin-top: 0;
    font-size: 1.25rem;
  }

  .toc ul {
    list-style: none;
    padding-left: 0;
  }

  .toc li {
    margin: 0.5rem 0;
  }

  .toc a {
    color: var(--color-primary);
    text-decoration: none;
  }

  .toc a:hover {
    text-decoration: underline;
  }

  .note {
    background: rgba(var(--color-primary-rgb), 0.1);
    border-left: 4px solid var(--color-primary);
    padding: 1rem;
    margin: 1.5rem 0;
    border-radius: var(--radius-sm);
  }

  .inline-code {
    background: rgba(0, 0, 0, 0.05);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-family: var(--font-mono);
    font-size: 0.9em;
  }
</style>
