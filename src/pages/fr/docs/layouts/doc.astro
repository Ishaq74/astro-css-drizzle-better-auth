---
import DocLayout from "@layouts/DocLayout.astro";
import { Code } from "astro:components";
import Alert from "@components/ui/Alert.astro";
import Card from "@components/ui/Card/Card.astro";
import CardHeader from "@components/ui/Card/CardHeader.astro";
import CardContent from "@components/ui/Card/CardContent.astro";
import TOC from "@components/templates/docs/TableOfContents.astro";
import Table from "@components/ui/Table/Table.astro";
import TableBody from "@components/ui/Table/TableBody.astro";
import TableCell from "@components/ui/Table/TableCell.astro";
import TableHead from "@components/ui/Table/TableHead.astro";
import TableHeader from "@components/ui/Table/TableHeader.astro";
import TableRow from "@components/ui/Table/TableRow.astro";
import Badge from "@components/ui/Badge.astro";
---

<DocLayout 
  title="DocLayout" 
  description="Layout sp√©cialis√© pour les pages de documentation avec sidebar, TOC et navigation" 
  variant="initial"
>
  <h1 id="doclayout">DocLayout</h1>

  <p>
    Le <code class="inline-code">DocLayout</code> est un layout sp√©cialis√© pour les pages de documentation. 
    Il √©tend BaseLayout et ajoute une sidebar de navigation, une table des mati√®res dynamique et un style optimis√© pour la lecture.
  </p>

  <TOC
    items={[
      { label: "Utilisation", href: "#utilisation" },
      { label: "Props", href: "#props" },
      { label: "Fonctionnalit√©s", href: "#fonctionnalites" },
      { label: "Exemple complet", href: "#exemple" },
      { label: "Sidebar de navigation", href: "#sidebar" },
      { label: "Table des mati√®res automatique", href: "#toc" },
    ]}
    title="Table des mati√®res"
  />

  <h2 id="utilisation">Utilisation</h2>

  <Code
    lang="astro"
    code={`---
import DocLayout from '@layouts/DocLayout.astro';
---

<DocLayout 
  title="Mon Composant"
  description="Documentation du composant"
  variant="initial"
>
  <h1 id="titre">Mon Composant</h1>
  <h2 id="section1">Section 1</h2>
  <p>Contenu...</p>
  <h2 id="section2">Section 2</h2>
  <p>Plus de contenu...</p>
</DocLayout>`}
  />

  <h2 id="props">Props</h2>

  <Table variant="initial">
    <TableHeader>
      <TableRow>
        <TableHead>Prop</TableHead>
        <TableHead>Type</TableHead>
        <TableHead>D√©faut</TableHead>
        <TableHead>Description</TableHead>
      </TableRow>
    </TableHeader>
    <TableBody>
      <TableRow>
        <TableCell><code>title</code></TableCell>
        <TableCell><code>string</code></TableCell>
        <TableCell><code>required</code></TableCell>
        <TableCell>Titre de la page de documentation</TableCell>
      </TableRow>
      <TableRow>
        <TableCell><code>description</code></TableCell>
        <TableCell><code>string</code></TableCell>
        <TableCell><code>undefined</code></TableCell>
        <TableCell>Description meta de la page</TableCell>
      </TableRow>
      <TableRow>
        <TableCell><code>variant</code></TableCell>
        <TableCell><code>'initial' | 'retro' | 'modern' | 'futuristic'</code></TableCell>
        <TableCell><code>'initial'</code></TableCell>
        <TableCell>Style visuel de la documentation</TableCell>
      </TableRow>
    </TableBody>
  </Table>

  <Alert variant="initial" status="info">
    <strong>üìù Note :</strong> Le DocLayout h√©rite de toutes les props du BaseLayout (SEO, m√©tadonn√©es, etc.).
  </Alert>

  <h2 id="fonctionnalites">Fonctionnalit√©s</h2>

  <div class="feature-grid">
    <Card>
      <CardHeader>
        <h3 style="margin: 0;">üìö Sidebar Navigation</h3>
      </CardHeader>
      <CardContent>
        <p>Navigation contextuelle avec hi√©rarchie des pages, active state et search.</p>
      </CardContent>
    </Card>

    <Card>
      <CardHeader>
        <h3 style="margin: 0;">üìñ Table of Contents</h3>
      </CardHeader>
      <CardContent>
        <p>TOC g√©n√©r√©e automatiquement √† partir des headings H2 et H3 de la page.</p>
      </CardContent>
    </Card>

    <Card>
      <CardHeader>
        <h3 style="margin: 0;">üé® 4 Variants</h3>
      </CardHeader>
      <CardContent>
        <p>Support complet des 4 variants visuels (initial, retro, modern, futuristic).</p>
      </CardContent>
    </Card>

    <Card>
      <CardHeader>
        <h3 style="margin: 0;">üì± Responsive</h3>
      </CardHeader>
      <CardContent>
        <p>Sidebar collapsible sur mobile avec menu hamburger.</p>
      </CardContent>
    </Card>

    <Card>
      <CardHeader>
        <h3 style="margin: 0;">üîç Optimis√© lecture</h3>
      </CardHeader>
      <CardContent>
        <p>Largeur de contenu optimale (max-width), line-height et typographie lisible.</p>
      </CardContent>
    </Card>

    <Card>
      <CardHeader>
        <h3 style="margin: 0;">üéØ Active state</h3>
      </CardHeader>
      <CardContent>
        <p>Highlight automatique de la page active et scroll spy pour le TOC.</p>
      </CardContent>
    </Card>
  </div>

  <h2 id="exemple">Exemple complet</h2>

  <Code
    lang="astro"
    code={`---
import DocLayout from '@layouts/DocLayout.astro';
import { Code } from 'astro:components';
import Alert from '@components/ui/Alert.astro';
---

<DocLayout 
  title="Button Component"
  description="Documentation compl√®te du composant Button"
  variant="modern"
>
  <h1 id="button-component">Button Component</h1>
  
  <p>
    Le composant Button est un √©l√©ment 
    interactif r√©utilisable.
  </p>

  <h2 id="installation">Installation</h2>
  <Code lang="bash" code="npm install" />

  <h2 id="usage">Utilisation</h2>
  <p>Exemple d'utilisation...</p>

  <h2 id="props">Props</h2>
  <p>Liste des propri√©t√©s disponibles...</p>

  <Alert>
    <strong>Note:</strong> Le composant est accessible.
  </Alert>
</DocLayout>`}
  />

  <h2 id="sidebar">Sidebar de navigation</h2>

  <p>La sidebar est g√©n√©r√©e automatiquement depuis le fichier de configuration :</p>

  <pre><code>{`// src/components/templates/docs/navigation.ts
export const getDocNavConfig = (locale: string, t: any) => [
  {
    title: t.docsSidebar.gettingStarted,
    items: [
      { label: t.docsSidebar.introduction, href: \`/\${locale}/docs/design\` },
    ]
  },
  {
    title: t.docsSidebar.uiAtoms,
    items: [
      { label: t.docsSidebar.button, href: \`/\${locale}/docs/design/button\` },
      { label: t.docsSidebar.input, href: \`/\${locale}/docs/design/input\` },
    ]
  }
];`}</code></pre>

  <Alert variant="initial" status="info">
    <strong>üåç Multilingue :</strong> La sidebar utilise les traductions du syst√®me i18n et s'adapte 
    automatiquement √† la locale courante.
  </Alert>

  <h2 id="toc">Table des mati√®res automatique</h2>

  <p>Le DocLayout g√©n√®re automatiquement une table des mati√®res √† partir des headings :</p>

  <ul>
    <li>‚úÖ D√©tecte automatiquement les H2 et H3 avec des IDs</li>
    <li>‚úÖ G√©n√®re les liens d'ancrage</li>
    <li>‚úÖ Indentation visuelle pour la hi√©rarchie</li>
    <li>‚úÖ Scroll spy pour highlight de la section active</li>
    <li>‚úÖ Smooth scroll au clic</li>
  </ul>

  <Code
    lang="astro"
    code={`<!-- IDs requis pour la TOC -->
<h2 id="installation">Installation</h2>
<h3 id="npm">Via npm</h3>
<h3 id="yarn">Via yarn</h3>
<h2 id="usage">Utilisation</h2>`}
  />

  <Alert variant="initial" status="warning">
    <strong>üí° Astuce :</strong> Utilisez toujours des IDs sur vos headings H2 et H3 pour activer la TOC automatique. 
    Les IDs doivent √™tre en kebab-case pour de meilleurs URLs.
  </Alert>

  <h2>Structure du layout</h2>

  <Code
    lang="html"
    code={`<BaseLayout>
  <div class="doc-layout">
    <!-- Sidebar gauche -->
    <Sidebar currentPath={Astro.url.pathname} />
    
    <!-- Contenu principal -->
    <MainDoc>
      <slot /> <!-- Votre contenu ici -->
    </MainDoc>
    
    <!-- TOC droite -->
    <aside class="doc-toc">
      <!-- TOC g√©n√©r√©e automatiquement -->
    </aside>
  </div>
</BaseLayout>`}
  />

  <h2>Grid Layout responsive</h2>

  <p>Le DocLayout utilise CSS Grid pour un layout flexible :</p>

  <ul>
    <li><strong>Desktop (> 1200px) :</strong> Sidebar (250px) | Contenu (1fr) | TOC (250px)</li>
    <li><strong>Tablet (768-1200px) :</strong> Sidebar (200px) | Contenu (1fr)</li>
    <li><strong>Mobile (&lt; 768px) :</strong> Contenu pleine largeur + menu hamburger</li>
  </ul>

  <h2>Variants</h2>

  <p>Le DocLayout supporte les 4 variants :</p>

  <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin: 1rem 0;">
    <Badge>initial</Badge>
    <Badge>retro</Badge>
    <Badge>modern</Badge>
    <Badge>futuristic</Badge>
  </div>

  <Code
    lang="astro"
    code={`<DocLayout variant="retro">
  <!-- Style r√©tro -->
</DocLayout>

<DocLayout variant="futuristic">
  <!-- Style futuriste -->
</DocLayout>`}
  />
</DocLayout>

<style>
  .toc {
    background: var(--bg-subtle);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md, 0.5rem);
    padding: 1.5rem;
    margin: 2rem 0;
  }

  .toc h2 {
    margin: 0 0 1rem 0;
    font-size: 1.25rem;
  }

  .toc ul {
    margin: 0;
    padding-left: 1.5rem;
  }

  .toc li {
    margin: 0.5rem 0;
  }

  .toc a {
    color: var(--color-primary);
    text-decoration: none;
  }

  .toc a:hover {
    text-decoration: underline;
  }

  .inline-code {
    background: var(--bg-inset);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm, 0.25rem);
    font-family: monospace;
    font-size: 0.9em;
    border: 1px solid var(--border-default);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    background: var(--bg-default);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md, 0.5rem);
    overflow: hidden;
  }

  thead {
    background: var(--bg-subtle);
  }

  th, td {
    padding: 0.75rem 1rem;
    text-align: left;
    border-bottom: 1px solid var(--border-default);
  }

  th {
    font-weight: 600;
  }

  tbody tr:last-child td {
    border-bottom: none;
  }

  tbody tr:hover {
    background: var(--bg-subtle);
  }

  code {
    font-family: monospace;
    font-size: 0.9em;
  }

  h1 {
    margin-bottom: 1rem;
  }

  h2 {
    margin: 3rem 0 1rem 0;
    padding-top: 1rem;
    border-top: 1px solid var(--border-default);
  }

  h2:first-of-type {
    margin-top: 2rem;
    border-top: none;
  }

  p {
    margin: 1rem 0;
    line-height: 1.6;
  }

  ul {
    line-height: 1.8;
  }

  ul li {
    margin: 0.5rem 0;
  }

  .feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
  }

  @media (max-width: 768px) {
    .feature-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
